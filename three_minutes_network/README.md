# [改訂新版] 3分間ネットワーク基礎講座
## 1章 ネットワークの基礎知識
### 回線交換とパケット交換
- データ通信には回線交換とパケット交換がある。コンピュータネットワークはパケット交換方式。  
データをパケットに分割して送るため回線を占有する時間が短く、回線を複数のコンピュータで共有できる。

### ネットワークの構造
- パケット交換機なしでケーブルの分岐でつながっている範囲のことをセグメントと呼ぶ。分岐させるためにハブという機器を使う。  
セグメントの範囲内にあるコンピュータはパケット交換機なしで直接データのやりとりができる。このようなネットワークの構造をマルチアクセスネットワークと呼ぶ。

- 一方、専用線を用いて固定した相手としかデータのやりとりができないネットワークをポイントツーポイントネットワークと呼ぶ。

### LANとWAN
- LAN（Local Area Network）は地域的に狭い範囲で自身の責任で構築するネットワーク。

- WAN（Wide Area Network）は離れた地域にあるLAN同士を電気通信事業者（NTTやKDDIなど）の通信ケーブルを借りてつないだネットワーク。  
世界規模で最大のWANがインターネット。

- インターネット接続サービスを行うプロバイダはISP（Internet Service Provider）と呼ばれる。

### OSI参照モデル
- OSI参照モデル（Open Systems Interconnection Reference Model）はデータ通信の標準化を行うために作られたデータ通信全体の「段階と手順の設計図」。 OSI参照モデルではデータ通信を7つの段階に分けている。この段階のことを層（レイヤー）と呼ぶ。

- レイヤーはそれぞれ独立している。すなわち、基本的にはレイヤーのプロトコル変更は他のレイヤーに影響しない。

- 下のレイヤーは上のレイヤーのために働き、上のレイヤーは下のレイヤーのことに関知しない。

### カプセル化
- データとデータを送るために必要なものがまとまった状態をプロトコルデータユニット（PDU）と呼ぶ。
それぞれのレイヤーごとにPDUがあり、それらが順々にくっついて実際に送信するPDUができるイメージ。  
このようにデータに制御情報をくっつけてPDUを作り上げることを **カプセル化** と呼ぶ。

- カプセル化で追加される制御情報は、データの前につくときはヘッダー、うしろにつくときはトレーラーと呼ぶ。

### プロトコル
- OSI参照モデルのレイヤーごとに、それぞれのレイヤーの役割のプロトコルが必要。

- 上下のプロトコルをインターフェースでつなぐことでレイヤー7からレイヤー1までを一つのつながったプロトコル群と捉えることができる。基本的にはどのプロトコル群を使うかによって各レイヤーで使用するプロトコルが決まる。  
現在最も使われているのがインターネットで使われているTCP/IPプロトコル群である。

- プロトコルは「データの中身を決める」「ヘッダーを決める」「やりとりの手順を決める」

### TCP/IP モデル
- TCP/IPはIETF（the Internet Engineering Task Force）が制定している。  
IETFが制定する文章はRFC（Request For Comment）と呼ばれる。

## 2章 信号の伝送と衝突
### レイヤー1の役割と概要
- レイヤー1の役割は、ケーブルがつながっている機器への信号の伝達。

- 信号が流れるパイプとなる通信媒体には有線と無線があり、優先には電気信号を使う銅線のUTP（Unshielded Twist Pari Code）と光信号を使う光ファイバーがある。

- コンピュータとケーブルの仲介役であるインターフェースは、コンピュータが送りたいデータをケーブルに合った信号に変換してケーブルに流し、ケーブルから流れてきた信号をコンピュータで使うデータに変換する。

- コンピュータで使われるインターフェースとして、LAN用のケーブルに接続するためのNIC（Network Interface Card）が一般的。

- WANの場合の信号変換器をDCE（Data Circuit terminating Equipment：回線終端装置）と呼ぶ。

### 信号と衝突
- インターフェースはビットを信号に、信号をビットに変換する機器である。信号にはアナログ信号とデジタル信号がある。

- ビットは「0」か「1」、デジタル信号は「ON」か「OFF」であるため、デジタル信号はビットを表現しやすい。

- 信号には減衰、ノイズ・干渉、衝突などの問題が発生する。

### ハブ
- ハブの機能１：複数の機器をつなげてネットワークを構築する機能。ハブにケーブルでつながっている機器は、同一のケーブルにつながっているのと同じ扱いになり、ハブにつながっている機器同士で信号のやりとりが可能になる。

- ハブの機能２：ハブは減衰によって崩れた信号を元の形に増幅・成形する。増幅だけを行う機械としてリピーターというものがある。

- ハブとハブをつなぐ接続をカスケード接続と呼ぶ。ハブをカスケード接続していけば大きなネットワークを作ることができる。

- ハブは受信したポート以外のすべてのポートに受信した信号を送信する。これをフラッディング（Flooding）と呼ぶ。

- 信号を送信すると衝突が起きるかもしれない範囲のことを衝突ドメインと呼ぶ。同じハブにつながっているコンピュータ同士は同時に信号を送信すると衝突が発生する可能性があるため、ハブでつながっている範囲は衝突ドメインにあることになる。（違うハブにつながっていてもハブ同士をカスケード接続していると衝突ドメインになる）「たまたま同じタイミング」で信号を送信する可能性を減らすためには衝突ドメインは小さくしなければならない。

### レイヤー2の役割と概要
- レイヤー2では、信号が届く範囲であるセグメント内でのデータ通信を考える。

- レイヤー2ではWANとLANでルールが異なる。LANのデファクトスタンダードはイーサネット。

### レイヤー2アドレスとイーサネット
- アドレスはデータの送りかたによってユニキャスト、ブロードキャスト、マルチキャストの3種類存在する。  
ユニキャストは「1対1」の通信、ブロードキャストは「1対全」の全員宛の通信、マルチキャストは「1対多」の複数機器宛の通信。

- それぞれの機器は最低1つ以上のユニキャストアドレスを持つ。ルーターのように複数のインターフェースを持つ機器は、インターフェースごとにユニキャストアドレスを持つ。

- ユニキャストアドレスはユニークでなければならない。一方マルチキャストアドレスは「グループ番号」といった扱いであるため、同じアドレスを持つ機器が複数あってもよい。

- イーサネットで使われるアドレスはMACアドレス（Media Access Control Address）と呼ばれるアドレスで、このアドレスはインターフェースにつけられた固定のアドレスである。

### イーサネット
- イーサネットでは「イーサネットヘッダー」と「イーサネットトレーラー」をデータグラムにつけて「イーサネットフレーム」にカプセル化する。  
ヘッダーには宛先のMACアドレス、送信元のMACアドレス、中身を識別するタイプがつき、トレーラーにはエラーチェックを行うFCS（Frame Check Sequence）がつく。

- イーサネットではハブによりすべての機器に届いたフレームは自分宛以外の場合は破棄する。

- イーサネットでは、CSMA/CD（Carrier Sense Multiple Access / Collision Detection）というアクセス制御によりなるべく衝突が起きないようにしている。

### スイッチ
- CSMA/CDは衝突を起こりにくくする仕組みであるため、衝突ドメインのコンピュータの台数が多い場合、衝突が起きて効率が悪くなる。これを防ぐために「信号が通る道を分ける」ための機器であるスイッチ（スイッチングハブ、L2スイッチなどとも呼ばれる）をハブの代わりに使用する。

- 現在LANで使われているUTPや光ファイバーのケーブルは送信と受信の信号の通り道は分かれている。そのため衝突はケーブル上では発生せず、ハブで発生する。スイッチは「MACアドレスフィルタリング」と「バッファリング」で衝突を防ぐ。

- スイッチはフレームを受信した際、送信元MACアドレスと受信したポートの対応をアドレステーブルという対応表の形で記憶する。これにより宛先MACアドレスに対応したポートからのみフレームを送信するのがMACアドレスフィルタリングである。  
MACアドレスフィルタリングにより別の宛先のフレームが同時にスイッチに届いても衝突が発生しなくなる。

### 全二重イーサネット
- 宛先が同じフレームが同時にスイッチに届いた場合、1つは送信して、もう一つは一時的にバッファーに退避させ、1つ目のフレームの送信が終わったら退避させていたフレームを送信する。これがバッファリング。ただしバッファーの容量は有限であるため無限に退避できるわけではない。

- スイッチの普及によりCSMA/CDを使う必要がなくなり送信と受信が同時にできる全二重イーサネットが当たり前になっている。
